package com.bo.net {	import com.adobe.crypto.MD5;	import com.bo.events.MyEvent;	import com.bo.utils.XMLParser;	import com.debugTip.DebugTip;		import flash.events.Event;	import flash.events.IOErrorEvent;	import flash.events.SecurityErrorEvent;	import flash.net.URLLoader;	import flash.net.URLRequest;
		public class OMSLoader{		private var url:String;		private var urlloader:URLLoader;		private var public_key:String="oms_flash";		private var private_key:String="523586d8c4bd7683219af0d112432e20b46455";		private var access_token:String="";		public function OMSLoader() {			// constructor code		}		public function loadxml():void{			if(Global.xmlid.indexOf("/")==0)Global.xmlid=Global.xmlid.substr(1);			url="http://oms.kankanews.com/oms/share/get_video_url_xml.php?omsid="+Global.omsid+"&t="+ int(Math.random() * 100000000);			access_token=MD5.hash("api_key="+public_key+"&omsid="+Global.omsid+private_key);			url="http://interface.kankanews.com/kkapi/v/get_video_url_xml.php?omsid="+Global.omsid+"&api_key="+public_key+"&access_token="+access_token+"&t="+ int(Math.random() * 100000000);			//url="http://114.80.151.69/oms/share/get_video_url_xml.php?omsid="+Global.omsid+"&t="+Math.random();			DebugTip.instance.log("========================xml_address========================");			DebugTip.instance.log(url);			DebugTip.instance.log("========================xml_address========================");			urlloader=new URLLoader();			urlloader.addEventListener(Event.COMPLETE,onxmlcomplete);			urlloader.addEventListener(IOErrorEvent.IO_ERROR,onIOError);			urlloader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,onIOError);			urlloader.load(new URLRequest(url));		}		private function onxmlcomplete(evt:Event):void{			urlloader.removeEventListener(Event.COMPLETE,onxmlcomplete);			urlloader.removeEventListener(IOErrorEvent.IO_ERROR,onIOError);			urlloader.removeEventListener(SecurityErrorEvent.SECURITY_ERROR,onIOError);			XMLParser.parseOMSXML(new XML(urlloader.data));			trace("onxmlcomplete");			Global.notificationCenter.postEvent(new MyEvent(MyEvent.POSTEVENT,MyEvent.OMSXMLCOMPLETE));		}		private function onIOError(evt:Event):void{			DebugTip.instance.log("-------security error on omsloader");			urlloader.removeEventListener(Event.COMPLETE,onxmlcomplete);			urlloader.removeEventListener(IOErrorEvent.IO_ERROR,onIOError);			urlloader.removeEventListener(SecurityErrorEvent.SECURITY_ERROR,onIOError);			Global.notificationCenter.postEvent(new MyEvent(MyEvent.POSTEVENT,MyEvent.OMSXMLERROR));		}	}	}